<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">scripts/experiments/ensemble_average/ensemble_average.js | vcl-web-framework</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<script src="./inject/script/0-conditions-config.js"></script><script src="./inject/script/0-experiments-config.js"></script><script src="./inject/script/0-graphing-config.js"></script><script src="./inject/script/0-trial-structure-config.js"></script><script src="./inject/script/0-balancing-config.js"></script><script src="./inject/script/0-view-controller.js"></script><script src="./inject/script/0-experiments-renderer.js"></script><script src="./inject/script/0-conditions-renderer.js"></script><script src="./inject/script/0-supported-properties-renderer.js"></script><link rel="stylesheet" href="./inject/css/0-styles.css"><meta name="description" content="This is a Node.js application that runs correlation-related experiments of the VCL Lab."><meta property="twitter:card" content="summary"><meta property="twitter:title" content="vcl-web-framework"><meta property="twitter:description" content="This is a Node.js application that runs correlation-related experiments of the VCL Lab."></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/UBC-VCL/VCLWebFramework.git"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-balancing">experiment-properties/balancing</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-balance_subconditions">balance_subconditions</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-balancing-balancing-helpers">experiment-properties/balancing/balancing_helpers</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_index_array">generate_index_array</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_any_array">get_any_array</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_any_array_repeated">get_any_array_repeated</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_permutation">get_permutation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_remaining_elements">get_remaining_elements</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-heapsPermute">heapsPermute</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-reorder">reorder</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-shuffle">shuffle</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-balancing-generators">experiment-properties/balancing/generators</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-initialize_blocked_latin_square">initialize_blocked_latin_square</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-innitialize_custom_latin_square">innitialize_custom_latin_square</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_counter_balanced_order">generate_counter_balanced_order</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-innitialize_custom_order">innitialize_custom_order</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-initialize_latin_square">initialize_latin_square</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-initialize_random_order">initialize_random_order</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-counter">experiment-properties/counter</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-print_curr_trial">print_curr_trial</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-data">experiment-properties/data</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_custom_subcondition">get_custom_subcondition</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_condition_dataset">create_condition_dataset</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_design_condition_dataset">create_design_condition_dataset</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_data">get_data</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_data_subset">get_data_subset</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CUSTOM_TRIAL_STRUCTURE_CONDITIONS">CUSTOM_TRIAL_STRUCTURE_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EXPERIMENT_BASES">EXPERIMENT_BASES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EXPERIMENT_CONDITIONS">EXPERIMENT_CONDITIONS</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-data-constants">experiment-properties/data/constants</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ENSEMBLE_AVERAGE_BASE">ENSEMBLE_AVERAGE_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ENSEMBLE_AVERAGE_CONDITIONS">ENSEMBLE_AVERAGE_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ESTIMATION_CONDITIONS">ESTIMATION_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-HYBRID_BASE">HYBRID_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-HYBRID_CONDITIONS">HYBRID_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_BASE">JND_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_CONDITIONS">JND_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_RADIUS_BASE">JND_RADIUS_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_RADIUS_CONDITIONS">JND_RADIUS_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-NUMEROSITY_BASE">NUMEROSITY_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-NUMEROSITY_CONDITIONS">NUMEROSITY_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SEQUENCING_BASE">SEQUENCING_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SEQUENCING_CONDITIONS">SEQUENCING_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SEQUENCING_SIDE_BY_SIDE_BASE">SEQUENCING_SIDE_BY_SIDE_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SEQUENCING_SIDE_BY_SIDE_CONDITIONS">SEQUENCING_SIDE_BY_SIDE_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SEQUENCING_SYMBOLS_BASE">SEQUENCING_SYMBOLS_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SEQUENCING_SYMBOLS_CONDITIONS">SEQUENCING_SYMBOLS_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STEVENS_BASE">STEVENS_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STEVENS_CONDITIONS">STEVENS_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-VISUAL_SEARCH_BASE">VISUAL_SEARCH_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-VISUAL_SEARCH_CONDITIONS">VISUAL_SEARCH_CONDITIONS</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-distribution">experiment-properties/distribution</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_adjusted_distribution">generate_adjusted_distribution</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_initial_distribution">generate_initial_distribution</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_random_distribution">generate_random_distribution</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-correlationNotWithinError">correlationNotWithinError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generateDistribution">generateDistribution</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generateRandomGaussian">generateRandomGaussian</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getPearsonCorrelation">getPearsonCorrelation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-pointNotWithinRequiredStdDevs">pointNotWithinRequiredStdDevs</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-prepare_coordinates">prepare_coordinates</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-random_bm">random_bm</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-readjustPoints">readjustPoints</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-transformPoints">transformPoints</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generateRandomDistribution">generateRandomDistribution</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generateRandomUniform">generateRandomUniform</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generateUniformDistribution">generateUniformDistribution</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-graphing">experiment-properties/graphing</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_color">generate_color</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_color_hex">generate_color_hex</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-is_custom_plot">is_custom_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-prepare_custom_plot">prepare_custom_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-add_graph_features">add_graph_features</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_attributes_object">generate_attributes_object</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-plot_distributions">plot_distributions</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-graphing-d3-base-plots">experiment-properties/graphing/d3-base-plots</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_parallel_plot">create_parallel_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_ring_plot">create_ring_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_scatter_plot">create_scatter_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-plot_scatter_points">plot_scatter_points</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_shape_plot">create_shape_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_strip_plot">create_strip_plot</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-graphing-d3-custom-plots">experiment-properties/graphing/d3-custom-plots</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_distractor_scatter_plot">create_distractor_scatter_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_estimation_bisection_plot">create_estimation_bisection_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_estimation_interference_plot">create_estimation_interference_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_estimation_multi_interference_plot">create_estimation_multi_interference_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_estimation_plot">create_estimation_plot</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-graphing-d3-plot-features">experiment-properties/graphing/d3-plot-features</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-combine_target_and_distractor">combine_target_and_distractor</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-plot_mixed_attribute_graph">plot_mixed_attribute_graph</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-prepare_array_mix_graph">prepare_array_mix_graph</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-prepare_mix_graph">prepare_mix_graph</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-prepare_targeted_mix_graph">prepare_targeted_mix_graph</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-prepare_visual_mask_graph">prepare_visual_mask_graph</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-instructions">experiment-properties/instructions</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_subcond_instruction_block">generate_subcond_instruction_block</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_instructions">get_instructions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_jspsych_instructions">get_jspsych_instructions</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-timeline-instruction-screen">experiment-timeline/instruction_screen</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_instructions">generate_instructions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_ready_screen">generate_ready_screen</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_sitting_distance_screen">generate_sitting_distance_screen</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_welcome">generate_welcome</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-timeline-resolution-scaling">experiment-timeline/resolution_scaling</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-manual_resolution_scaling">manual_resolution_scaling</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-resolution_scaling">resolution_scaling</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-timeline-screening">experiment-timeline/screening</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-screeningInstructions">screeningInstructions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-screeningPCPInverted">screeningPCPInverted</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-instructionsRegression">instructionsRegression</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-screeningCorrelationSelect">screeningCorrelationSelect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-screeningCorrelationSort">screeningCorrelationSort</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-screeningInstructions">screeningInstructions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-screeningQuestions">screeningQuestions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-screeningRegressionSelect">screeningRegressionSelect</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-colorScreeningInstructions">colorScreeningInstructions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ignoreScreeningInstructions">ignoreScreeningInstructions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-luminanceScreeningInstructions">luminanceScreeningInstructions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-orientationScreeningInstructions">orientationScreeningInstructions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-screeningStripColorYellowBlue">screeningStripColorYellowBlue</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-screenningStripLuminanceSort">screenningStripLuminanceSort</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-screenningStripOrientationSort">screenningStripOrientationSort</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-ensemble-average">experiments/ensemble_average</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/ensemble_average/ensemble_average.js~Ensemble_Average.html">Ensemble_Average</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ensemble_avg_exp">ensemble_avg_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-estimation">experiments/estimation</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/estimation/estimation.js~Estimation.html">Estimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-estimation_exp">estimation_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-hybrid">experiments/hybrid</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/hybrid/hybrid.js~Hybrid.html">Hybrid</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-hybrid_exp">hybrid_exp</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-jnd_exp">jnd_exp</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-stevens_exp">stevens_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-jnd">experiments/jnd</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/jnd/jnd.js~JND.html">JND</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_experiment_block">generate_experiment_block</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_experiment_end">generate_experiment_end</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_feedback_screen">generate_feedback_screen</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_practice_block">generate_practice_block</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_ready_experiment">generate_ready_experiment</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_stop_block">generate_stop_block</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-jnd_exp">jnd_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-jnd-radius">experiments/jnd_radius</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/jnd_radius/jnd_radius.js~JND_Radius.html">JND_Radius</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-jnd_radius_exp">jnd_radius_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-numerosity">experiments/numerosity</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/numerosity/numerosity.js~Numerosity.html">Numerosity</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-numerosity_exp">numerosity_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-sequencing">experiments/sequencing</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/sequencing/sequencing.js~Sequencing.html">Sequencing</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-IMAGE_PATH">IMAGE_PATH</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-sequencing_exp">sequencing_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-sequencing-side-by-side">experiments/sequencing_side_by_side</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/sequencing_side_by_side/sequencing_side_by_side.js~Sequencing_Side_by_Side.html">Sequencing_Side_by_Side</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-IMAGE_PATH">IMAGE_PATH</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-sequencing_side_by_side_exp">sequencing_side_by_side_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-sequencing-symbols">experiments/sequencing_symbols</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/sequencing_symbols/sequencing_symbols.js~Sequencing_Symbols.html">Sequencing_Symbols</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_experiment">generate_experiment</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_experiment_end">generate_experiment_end</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_feedback_screen">generate_feedback_screen</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_feedback_wrapper">generate_feedback_wrapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_practice_block">generate_practice_block</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_practice_instruction_block">generate_practice_instruction_block</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_stop_practice_trials">generate_stop_practice_trials</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-RECTANGLE_MASK_PATH">RECTANGLE_MASK_PATH</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-SQUARE_MASK_PATH">SQUARE_MASK_PATH</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-sequencing_symbols_exp">sequencing_symbols_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-stevens">experiments/stevens</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/stevens/stevens.js~Stevens.html">Stevens</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-stevens_exp">stevens_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-visual-search">experiments/visual_search</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/visual_search/visual_search_timeline.js~Visual_Search.html">Visual_Search</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_color_paths">get_color_paths</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-hex_to_color">hex_to_color</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-visual_search_exp">visual_search_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#helpers">helpers</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/helpers/correlation_dependencies.js~Correlation_Dependencies.html">Correlation_Dependencies</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-above_and_below_generate_random_trial_array">above_and_below_generate_random_trial_array</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-bundle_z_values">bundle_z_values</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-check_params">check_params</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-force_greater_right_position">force_greater_right_position</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_feature_search_trials">generate_feature_search_trials</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-generate_timeline_screen">generate_timeline_screen</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-genereate_hybrid_instruction">genereate_hybrid_instruction</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-getScreenHeight">getScreenHeight</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_mixed_graph_styles">get_mixed_graph_styles</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_mixed_masks">get_mixed_masks</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_num_blocks">get_num_blocks</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_running_average">get_running_average</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_single_graph_style">get_single_graph_style</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_single_mask">get_single_mask</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-is_converged_in_window">is_converged_in_window</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-nova_variables">nova_variables</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-randomize_graph_attributes_mixed">randomize_graph_attributes_mixed</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-randomize_position">randomize_position</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-randomize_position_symmetric">randomize_position_symmetric</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-randomize_radius_position">randomize_radius_position</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-repeat_y_values">repeat_y_values</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-shuffleArray">shuffleArray</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-correlation_dependencies">correlation_dependencies</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">scripts/experiments/ensemble_average/ensemble_average.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import { get_data } from &quot;/scripts/experiment-properties/data/data_controller.js&quot;;
import { balance_subconditions } from &quot;/scripts/experiment-properties/balancing/balancing_controller.js&quot;;
import { generateDistribution } from &quot;/scripts/experiment-properties/distribution/gaussian_distribution_generator.js&quot;;

export default class Ensemble_Average {
  /**
   * Initializes a Ensemble Average experiment object.
   *
   * @param  {assoc array}  Parameters passed from routing.
   */
  constructor(params) {

    // let trial_structure = params[&quot;trial_structure&quot;];
    // let condition_name = params[&quot;condition&quot;];
    // let graph_type = params[&quot;graph_type&quot;];
    // let balancing_type = params[&quot;balancing&quot;];
    let conversion_factor = params[&quot;conversion_factor&quot;];

    // ========================================
    // EXPERIMENT CONSTANTS

    this.PIXELS_PER_CM = conversion_factor;


    this.balancing_type = params[&quot;balancing&quot;];
    this.condition_name = params[&quot;condition&quot;];
    this.graph_type = params[&quot;graph_type&quot;];
    this.subject_id = params[&quot;subject_id&quot;];
    this.subject_initials = params[&quot;subject_initials&quot;];
    this.trial_structure = params[&quot;trial_structure&quot;];

    // Condition group used to classify the type of graph (e.g. distractor)
    this.condition_group = this.condition_name.split(&quot;_&quot;)[0];

    // Coordinates
    this.coordinates = [];
    this.distractor_coordinates = [];

    // Automation mode
    this.auto_mode = false;

    // Randomly ordered trials and its current index
    this.trials = shuffle(this.balancing_type, this.constructor.name.toLowerCase(), get_data(this));
    this.trial_index = 0;

    // JsPsych trial_data for the current trial
    // TODO
    this.trial_data = &quot;&quot;;

    function shuffle(balancing_type, constructor_name, ordered_data) {
      const random_order = balance_subconditions(
        balancing_type,
        constructor_name,
        ordered_data.length
      );
      let shuffled_data = [];
      for (let i = 0; i &lt; random_order.length; i++) {
        shuffled_data[i] = ordered_data[random_order[i]];
      }
      return shuffled_data;
    }
  }

   /**
   * Generates a graph of Ensemble Average for timeline to use
   *
   * @return trial {object}
   */
  generate_trial() {
    // Initialize a variable for this so it is usable inside on_start
    var ensemble_avg_exp = this;
    var address = location.protocol + &quot;//&quot; + location.hostname + &quot;:&quot; + location.port + &quot;/ensemble_average_trial&quot;;

    var trial = {
      type: &quot;external-html-keyboard-response&quot;,
      url: address,
      trial_duration: 1000,
      choices: [&quot;t&quot;],
      on_start: function (trial) {
        // NOTE: on_start takes in trial var

        if (ensemble_avg_exp.auto_mode) {
          trial.post_trial_gap = 0;
          trial.trial_duration = 0;
        }

        // Set the constants to be used:

        var index = ensemble_avg_exp.trial_index;
        var constants = ensemble_avg_exp.trials[index];

        var base_coordinates = generateDistribution(
          constants.base_correlation,
          constants.error,
          constants.num_points,
          constants.num_SD,
          constants.mean,
          constants.SD
        );

        ensemble_avg_exp.coordinates = [base_coordinates];

        var distractor_coordinates = generateDistribution(
          constants.dist_base,
          constants.error,
          constants.num_points,
          constants.num_SD,
          constants.mean,
          constants.SD
        );

        ensemble_avg_exp.distractor_coordinates = [distractor_coordinates];

        ensemble_avg_exp.trial_data = constants;

        console.log(&quot;constants&quot;);
        console.log(constants);
      },
    };

    
    return trial;
  }

   /**
   * Generates a cue of Ensemble Average for timeline to use
   *
   * @return trial {object}
   */
  generate_cue() {

    var ensemble_avg_exp = this;

    var cue = {
        type: &quot;html-keyboard-response&quot;,
        stimulus: &quot;&quot;,
        data: { type: &quot;cue&quot; },
        on_start: function(trial) {
          trial.stimulus = cue_selector();
        }
    };

    return cue;
    
    function cue_selector() {
        const no_cue = 
            `
            &lt;div style=&quot;text-align: center;&quot;&gt;
                &lt;p style=&quot;font-size: 50px; line-height: 70px;&quot;&gt;
                    You are about to see a scatterplot with two populations of data.
                &lt;/p&gt;
            &lt;/div&gt;
            `;

        const cue_blue_color = 
            `
            &lt;div style=&quot;text-align: center;&quot;&gt;
                &lt;p style=&quot;font-size: 50px; line-height: 70px;&quot;&gt;
                    You are about to see a scatterplot with two populations of data.
                    &lt;/br&gt;
                    &lt;b&gt;
                      Pay attention to the &lt;font color=&quot;blue&quot;&gt;blue&lt;/font&gt; dots.
                    &lt;/b&gt;
                &lt;/p&gt;
            &lt;/div&gt;
            `;

        const cue_orange_color = 
            `
            &lt;div style=&quot;text-align: center;&quot;&gt;
                &lt;p style=&quot;font-size: 50px; line-height: 70px;&quot;&gt;
                    You are about to see a scatterplot with two populations of data.
                    &lt;/br&gt;
                    &lt;b&gt;
                      Pay attention to the &lt;font color=&quot;orange&quot;&gt;orange&lt;/font&gt; dots.
                    &lt;/b&gt;
                &lt;/p&gt;
            &lt;/div&gt;
            `;
        
        const cue_more_correlated = 
            `
            &lt;div style=&quot;text-align: center;&quot;&gt;
                &lt;p style=&quot;font-size: 50px; line-height: 70px;&quot;&gt;
                    You are about to see a scatterplot with two populations of data.
                    &lt;/br&gt;
                    &lt;b&gt;
                      Pay attention to the more correlated population.     
                    &lt;/b&gt;
                &lt;/p&gt;
            &lt;/div&gt;
            `;

        const cue_less_correlated = 
            `
            &lt;div style=&quot;text-align: center;&quot;&gt;
                &lt;p style=&quot;font-size: 50px; line-height: 70px;&quot;&gt;
                    You are about to see a scatterplot with two populations of data.
                    &lt;/br&gt;
                    &lt;b&gt;
                      Pay attention to the less correlated population.      
                    &lt;/b&gt;  
                &lt;/p&gt;
            &lt;/div&gt;
            `;

        console.log(&quot;ensemble_avg_exp.trial_index:&quot; + ensemble_avg_exp.trial_index)
        console.log(&quot;ensemble_avg_exp.trials[ensemble_avg_exp.trial_index]:&quot; + ensemble_avg_exp.trials[ensemble_avg_exp.trial_index])

        const current_trial = ensemble_avg_exp.trials[ensemble_avg_exp.trial_index];


        if (current_trial.cue == &quot;None&quot;) {
          return no_cue
        } else if (current_trial.cue == &quot;blue&quot;) {
          return cue_blue_color;
        } else if (current_trial.cue == &quot;orange&quot;) {
          return cue_orange_color;
        } else if (current_trial.cue == &quot;more correlated&quot;) {
          return cue_more_correlated;
        } else if (current_trial.cue == &quot;less correlated&quot;) {
          return cue_less_correlated;
        } else {
          console.error(&quot;Cue is neither on blue, orange, less correlated or more correlated dots&quot;);
        }
    }
  }

  /**
   * Generates a first probe of Ensemble Average for timeline to use
   *
   * @return trial {object}
   */
  // TODO 1
  generate_averaging_task() {

    var ensemble_avg_exp = this;

    var averaging_task = {
        type: &quot;html-keyboard-response&quot;,
        choices: [77, 90, 32, 81], // m = 77 (up), z = 90 (down), 32 = spacebar, 81 = q (exit button for debugging)
        trial_duration: 1000,
        stimulus: &quot;&quot;,
        data: { type: &quot;averaging_task&quot;},
        on_start: function(trial) {
          var dots_radius_min = 0;
          var dots_radius_max = 20;
          var dots_radius_adjustment = 0.5

          var last_trial_data = jsPsych.data.getLastTrialData().values()[0];
          var last_dots_radius = last_trial_data.dots_radius;

          if(last_dots_radius){
            var last_key_press = last_trial_data.key_press;
            if (last_key_press &amp;&amp; (last_key_press == trial.choices[0] || last_key_press == trial.choices[1])){
              if (last_key_press == trial.choices[0] &amp;&amp; (last_dots_radius + dots_radius_adjustment) &lt; dots_radius_max){ // up
                trial.data.dots_radius = last_dots_radius + dots_radius_adjustment;
              }else if (last_key_press == trial.choices[1] &amp;&amp; (last_dots_radius - dots_radius_adjustment) &gt; dots_radius_min){ // down
                trial.data.dots_radius = last_dots_radius - dots_radius_adjustment;
              }else{
                trial.data.dots_radius = last_dots_radius;
              }
            }else{
              trial.data.dots_radius = last_dots_radius;
            }
          }else{
            trial.data.dots_radius = Math.random() * (dots_radius_max - dots_radius_min) + dots_radius_min;
          }

          trial.stimulus = probe_selector(trial.data.dots_radius);
          console.log(&quot;dots radius: &quot; + trial.data.dots_radius)
        }
    };

    return averaging_task;
    
    function probe_selector(dots_radius) {
        const probe_blue_color = 
            `
            &lt;div style=&quot;text-align: center;&quot;&gt;
                &lt;p style=&quot;font-size: 50px; line-height: 70px;&quot;&gt;
                Adjust the dot here until it shows the average size of the blue dots from the previous display.
                &lt;/p&gt;
                &lt;p style=&quot;font-size: 20px; line-height: 50px;&quot;&gt;
                  (Note: press &#x201C;z&#x201D; to decrease the size; press &#x201C;m&#x201D; to increase the size; press &#x201C;space&#x201D; to confirm the size)
                &lt;/p&gt;
            &lt;/div&gt;
            &lt;svg width=&quot;100%&quot;&gt;
              &lt;circle cx=50% cy=50% r=&quot;${dots_radius}&quot;/&gt;
            &lt;/svg&gt;
            `;

        const probe_orange_color = 
            `
            &lt;div style=&quot;text-align: center;&quot;&gt;
                &lt;p style=&quot;font-size: 50px; line-height: 70px;&quot;&gt;
                  Adjust the dot here until it shows the average size of the orange dots from the previous display. 
                &lt;/p&gt;
                &lt;p style=&quot;font-size: 20px; line-height: 50px;&quot;&gt;
                  (Note: press &#x201C;z&#x201D; to decrease the size; press &#x201C;m&#x201D; to increase the size; press &#x201C;space&#x201D; to confirm the size)
                &lt;/p&gt;
            &lt;/div&gt;
            &lt;svg width=&quot;100%&quot;&gt;
              &lt;circle cx=50% cy=50% r=&quot;${dots_radius}&quot;/&gt;
            &lt;/svg&gt;
            `;
        
        const probe_more_correlated = 
            `
            &lt;div style=&quot;text-align: center;&quot;&gt;
                &lt;p style=&quot;font-size: 50px; line-height: 70px;&quot;&gt;
                  Adjust the dot here until it shows the average size of the more correlated population from the previous display.      
                &lt;/p&gt;
                &lt;p style=&quot;font-size: 20px; line-height: 50px;&quot;&gt;
                  (Note: press &#x201C;z&#x201D; to decrease the size; press &#x201C;m&#x201D; to increase the size; press &#x201C;space&#x201D; to confirm the size)
                &lt;/p&gt;
            &lt;/div&gt;
            &lt;svg width=&quot;100%&quot;&gt;
              &lt;circle cx=50% cy=50% r=&quot;${dots_radius}&quot;/&gt;
            &lt;/svg&gt;
            `;

        const probe_less_correlated = 
            `
            &lt;div style=&quot;text-align: center;&quot;&gt;
                &lt;p style=&quot;font-size: 50px; line-height: 70px;&quot;&gt;
                  Adjust the dot here until it shows the average size of the less correlated population from the previous display.
                &lt;/p&gt;
                &lt;p style=&quot;font-size: 20px; line-height: 50px;&quot;&gt;
                  (Note: press &#x201C;z&#x201D; to decrease the size; press &#x201C;m&#x201D; to increase the size; press &#x201C;space&#x201D; to confirm the size)
                &lt;/p&gt;
            &lt;/div&gt;
            &lt;svg width=&quot;100%&quot;&gt;
              &lt;circle cx=50% cy=50% r=&quot;${dots_radius}&quot;/&gt;
            &lt;/svg&gt;
            `;

        const current_trial = ensemble_avg_exp.trials[ensemble_avg_exp.trial_index];


        if (current_trial.size_average_probe == &quot;blue&quot;) {
          return probe_blue_color;
        } else if (current_trial.size_average_probe == &quot;orange&quot;) {
          return probe_orange_color;
        } else if (current_trial.size_average_probe == &quot;more correlated&quot;) {
          return probe_more_correlated;
        } else if (current_trial.size_average_probe == &quot;less correlated&quot;) {
          return probe_less_correlated;
        } else {
          console.error(&quot;Size averaging task is neither on blue, orange, less correlated or more correlated dots&quot;);
        }
        
    }
  }

  /**
   * Generates a second probe of Ensemble Average for timeline to use
   *
   * @return trial {object}
   */
  // TODO 2
  generate_correlation_probe() {
    var correlation_probe = {
        type: &quot;html-keyboard-response&quot;,
        choices: [77, 90], // m = 77 (orange), z = 90 (blue), 81 = q (exit button for debugging)
        stimulus: &quot;&quot;,
        data: { type: &quot;correlation_probe&quot; },
        on_start: function(trial) {
            trial.stimulus = `
            &lt;div style=&quot;text-align: center;&quot;&gt;
                &lt;p style=&quot;font-size: 50px; line-height: 70px;&quot;&gt;
                  Which color was showing the higher correlation value?
                &lt;/p&gt;
            &lt;/div&gt;
            &lt;svg width=&quot;100%&quot;&gt;
              &lt;circle cx=25% cy=50% r=&quot;30&quot; fill=&quot;blue&quot;/&gt;
              &lt;text x=&quot;25%&quot; y=&quot;50%&quot; text-anchor=&quot;middle&quot; fill=&quot;white&quot; font-size=&quot;20&quot; dy=&quot;.3em&quot;&gt;Z&lt;/text&gt;
              &lt;circle cx=75% cy=50% r=&quot;30&quot; fill=&quot;orange&quot;/&gt;
              &lt;text x=&quot;75%&quot; y=&quot;50%&quot; text-anchor=&quot;middle&quot; fill=&quot;white&quot; font-size=&quot;20&quot; dy=&quot;.3em&quot;&gt;M&lt;/text&gt;
            &lt;/svg&gt;
            `
        }
    };
    return correlation_probe;
  }

  generate_size_probe() {

    var size_probe = {
        type: &quot;html-keyboard-response&quot;,
        choices: [77, 90], // m = 77 (orange), z = 90 (blue), 81 = q (exit button for debugging)
        stimulus: &quot;&quot;,
        data: { type: &quot;size_probe&quot; },
        on_start: function(trial) {
            trial.stimulus = `
              &lt;div style=&quot;text-align: center;&quot;&gt;
                  &lt;p style=&quot;font-size: 50px; line-height: 70px;&quot;&gt;
                    Which color had a larger average size of dots?
                  &lt;/p&gt;
              &lt;/div&gt;
              &lt;svg width=&quot;100%&quot;&gt;
                &lt;circle cx=25% cy=50% r=&quot;30&quot; fill=&quot;blue&quot;/&gt;
                &lt;text x=&quot;25%&quot; y=&quot;50%&quot; text-anchor=&quot;middle&quot; fill=&quot;white&quot; font-size=&quot;20&quot; dy=&quot;.3em&quot;&gt;Z&lt;/text&gt;
                &lt;circle cx=75% cy=50% r=&quot;30&quot; fill=&quot;orange&quot;/&gt;
                &lt;text x=&quot;75%&quot; y=&quot;50%&quot; text-anchor=&quot;middle&quot; fill=&quot;white&quot; font-size=&quot;20&quot; dy=&quot;.3em&quot;&gt;M&lt;/text&gt;
              &lt;/svg&gt;
              `;
        }
    };
    return size_probe;
  }


  /**
   * Generates confidence check for timeline to use
   *
   * @return trial {object}
   */
  generate_confidence_check() {

    var slider_response = {
      type: &apos;html-slider-response&apos;,
      labels: [1,2,3,4,5],
      min: 1,
      max: 5,
      start: 3,
      stimulus: &quot;&quot;,
      prompt: &quot;&quot;,
      on_start: function(trial) {
          trial.stimulus = `
          &lt;div style=&quot;text-align: center;&quot;&gt;
              &lt;p style=&quot;font-size: 30px; line-height: 70px;&quot;&gt;
                How confident are you on your answers to the previous questions?
              &lt;/p&gt;
          &lt;/div&gt;
          `;
          trial.prompt = `
          &lt;div style=&quot;text-align: center;&quot;&gt;
              &lt;p style=&quot;font-size: 30px; line-height: 70px;&quot;&gt;
              Select the number by sliding the bar
              &lt;/p&gt;
          &lt;/div&gt;
          `
        }
    };

    return slider_response;
  }

  trial_is_over() {
    return this.trial_index == this.trials.length - 1;
  }

  go_next_trial() {
    this.trial_index++;
  }

  // TODO 3 (data saving)
  save_data(data) {
    // var csv = &apos;target_correlation,distractor_correlation,target_mean_size,distractor_mean_size,target_color,distractor_color,cue,size_average_probe,averaging_task_ans,correlation_probe_ans,size_probe_ans,confidence_level\n&apos;;
    var ensemble_avg_exp = this
    var raw_data = jsPsych.data.get()
    var max_trial_index = raw_data.last(1).values()[0].trial_index
    // var data = [];
    var index = 0;
    // for (let j = 0; j&lt;=max_trial_index; j++){
    //   //Data for a given trial of a sub condition
    //   var trial_data = raw_data.filter({trial_index: j});
    //   console.log(trial_data.last(1).values()[0])
    //   if(trial_data.last(1).values()[0] &amp;&amp; trial_data.last(1).values()[0].type == &quot;averaging_task&quot; &amp;&amp; trial_data.last(1).values()[0].key_press == &quot;32&quot;){
    //     // if this trial is the trial where the viewer pressed space when ask for the average dot size, 
    //     // then current trial has the averaging_task_ans, one trial after has the correlation_probe_ans, 
    //     var averaging_task_ans = raw_data.filter({trial_index: j}).last(1).values()[0].dots_radius
    //     var correlation_probe_ans = raw_data.filter({trial_index: j+1}).last(1).values()[0].key_press
    //     var size_probe_ans = raw_data.filter({trial_index: j+2}).last(1).values()[0].key_press
    //     var confidence_level = raw_data.filter({trial_index: j+3}).last(1).values()[0].response

    //     index++;
    //     var row = []
    //     var current_trial = ensemble_avg_exp.trials[index-1]
    //     row.push(current_trial.base_correlation);
    //     row.push(current_trial.dist_base);
    //     row.push(current_trial.target_mean_size);
    //     row.push(current_trial.distractor_mean_size);
    //     row.push(current_trial.mix_by_target_array[0].point_color); //target color
    //     row.push(current_trial.mix_by_distractor_array[0].point_color); //distractor color
    //     row.push(current_trial.cue);
    //     row.push(current_trial.size_average_probe);

    //     row.push(averaging_task_ans);

    //     //  z = 90 (blue), m = 77 (orange)
    //     if(correlation_probe_ans == &quot;90&quot;){
    //       row.push(&quot;BLUE&quot;);
    //     }else if(correlation_probe_ans == &quot;77&quot;){
    //       row.push(&quot;ORANGE&quot;);
    //     }

    //     //  z = 90 (blue), m = 77 (orange)
    //     if(size_probe_ans == &quot;90&quot;){
    //       row.push(&quot;BLUE&quot;);
    //     }else if(size_probe_ans == &quot;77&quot;){
    //       row.push(&quot;ORANGE&quot;);
    //     }

    //     row.push(confidence_level)

    //     data.push(row);
    //   }
    // }

    // // Append each row
    // data.forEach(function(row){
    //   csv += row.join(&apos;,&apos;);
    //   csv += &quot;\n&quot;;
    // });

    // var hiddenElement = document.createElement(&apos;a&apos;);
    // hiddenElement.href = &apos;data:text/csv;charset=utf-8,&apos; + encodeURI(csv);
    // hiddenElement.target = &apos;_blank&apos;;
    // hiddenElement.download = &quot;S&quot; + this.subject_id + &quot;_&quot; + this.condition_name + &quot;_ensemble_avg_trial_results.csv&quot;;
    // hiddenElement.click();

    var data = &quot;&quot;;
    for (let j = 0; j&lt;=max_trial_index; j++){
      var trial_data = raw_data.filter({trial_index: j});
      console.log(trial_data.last(1).values()[0])
      if(trial_data.last(1).values()[0] &amp;&amp; trial_data.last(1).values()[0].type == &quot;averaging_task&quot; &amp;&amp; trial_data.last(1).values()[0].key_press == &quot;32&quot;){
        // if this trial is the trial where the viewer pressed space when ask for the average dot size, 
        // then current trial has the averaging_task_ans, one trial after has the correlation_probe_ans, 
        var averaging_task_ans = raw_data.filter({trial_index: j}).last(1).values()[0].dots_radius
        var correlation_probe_ans = raw_data.filter({trial_index: j+1}).last(1).values()[0].key_press
        var size_probe_ans = raw_data.filter({trial_index: j+2}).last(1).values()[0].key_press
        var confidence_level = raw_data.filter({trial_index: j+3}).last(1).values()[0].response

        
        index++;

        var current_trial = ensemble_avg_exp.trials[index-1]
        data += `[{&quot;target_correlation&quot;: `
        data += current_trial.base_correlation;

        data += `, &quot;distractor_correlation&quot;: `
        data += current_trial.dist_base;

        data += `, &quot;target_mean_size&quot;: `
        data += current_trial.target_mean_size;

        data += `, &quot;distractor_mean_size&quot;: `
        data += current_trial.distractor_mean_size;

        data += `, &quot;target_color&quot;: &quot;`
        data += current_trial.mix_by_target_array[0].point_color;
        data += `&quot;`

        data += `, &quot;distractor_color&quot;: &quot;`
        data += current_trial.mix_by_distractor_array[0].point_color;
        data += `&quot;`

        data += `, &quot;cue&quot;: &quot;`
        data += current_trial.cue;
        data += `&quot;`

        data += `, &quot;size_average_probe&quot;: &quot;`
        data += current_trial.size_average_probe;
        data += `&quot;`

        data += `, &quot;averaging_task_ans&quot;: `
        data += averaging_task_ans;

        //  z = 90 (blue), m = 77 (orange)
        if(correlation_probe_ans == `90`){
          data += `, &quot;correlation_probe_ans&quot;: &quot;BLUE&quot;`
        }else if(correlation_probe_ans == `77`){
          data += `, &quot;correlation_probe_ans&quot;: &quot;ORANGE&quot;`
        }

        //  z = 90 (blue), m = 77 (orange)
        if(size_probe_ans == `90`){
          data += `, &quot;size_probe_ans&quot;: &quot;BLUE&quot;`
        }else if(size_probe_ans == `77`){
          data += `, &quot;size_probe_ans&quot;: &quot;ORANGE&quot;`
        }

        data += `, &quot;confidence_level&quot;: `
        data += confidence_level;

        data += `}]`;
      }
    }

    $.post(&quot;/api/experiment_data&quot;,
            // {json: raw_data.json(), experiment: &quot;JND&quot;, condition: params[&quot;condition&quot;], prolific_pid: params[&quot;prolific_pid&quot;], study_id: params[&quot;study_id&quot;], session_id: params[&quot;session_id&quot;]},
            {json: data, experiment: &quot;ENSEMBLE_AVERAGE&quot;, condition: params[&quot;condition&quot;], prolific_pid: params[&quot;prolific_pid&quot;], study_id: params[&quot;study_id&quot;], session_id: params[&quot;session_id&quot;]},
            function(data, status){
              console.log(&quot;Data: &quot; + data + &quot;\nStatus: &quot; + status);
            }
          );

  }
}</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
